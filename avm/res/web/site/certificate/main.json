{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "languageVersion": "2.0",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.36.177.2456",
      "templateHash": "2275827875194893112"
    },
    "name": "Web/Function Apps Certificates",
    "description": "This module deploys a Web/Function App Certificate."
  },
  "parameters": {
    "name": {
      "type": "string",
      "metadata": {
        "description": "Required. Certificate name."
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Optional. Resource location."
      }
    },
    "hostNames": {
      "type": "array",
      "defaultValue": [],
      "metadata": {
        "description": "Optional. Certificate host names."
      }
    },
    "tags": {
      "type": "object",
      "nullable": true,
      "metadata": {
        "description": "Optional. Tags of the resource."
      }
    },
    "kind": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. Kind of resource."
      }
    },
    "keyVaultId": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. Key Vault resource ID."
      }
    },
    "keyVaultSecretName": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. Key Vault secret name."
      }
    },
    "serverFarmResourceId": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. Server farm resource ID."
      }
    },
    "canonicalName": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. CNAME of the certificate to be issued via free certificate."
      }
    },
    "password": {
      "type": "securestring",
      "nullable": true,
      "metadata": {
        "description": "Optional. Certificate password."
      }
    },
    "pfxBlob": {
      "type": "securestring",
      "nullable": true,
      "metadata": {
        "description": "Optional. Certificate data in PFX format."
      }
    },
    "domainValidationMethod": {
      "type": "string",
      "nullable": true,
      "metadata": {
        "description": "Optional. Method of domain validation for free certificate."
      }
    }
  },
  "resources": {
    "certificate": {
      "type": "Microsoft.Web/certificates",
      "apiVersion": "2024-11-01",
      "name": "[parameters('name')]",
      "location": "[parameters('location')]",
      "kind": "[parameters('kind')]",
      "tags": "[parameters('tags')]",
      "properties": {
        "hostNames": "[if(not(empty(parameters('hostNames'))), parameters('hostNames'), null())]",
        "password": "[if(not(empty(parameters('password'))), parameters('password'), null())]",
        "pfxBlob": "[if(not(empty(parameters('pfxBlob'))), parameters('pfxBlob'), null())]",
        "serverFarmId": "[if(not(empty(parameters('serverFarmResourceId'))), parameters('serverFarmResourceId'), null())]",
        "keyVaultId": "[if(not(empty(parameters('keyVaultId'))), parameters('keyVaultId'), null())]",
        "keyVaultSecretName": "[if(not(empty(parameters('keyVaultSecretName'))), parameters('keyVaultSecretName'), null())]",
        "canonicalName": "[if(not(empty(parameters('canonicalName'))), parameters('canonicalName'), null())]",
        "domainValidationMethod": "[if(not(empty(parameters('domainValidationMethod'))), parameters('domainValidationMethod'), null())]"
      }
    }
  },
  "outputs": {
    "resourceId": {
      "type": "string",
      "metadata": {
        "description": "The resource ID of the certificate."
      },
      "value": "[resourceId('Microsoft.Web/certificates', parameters('name'))]"
    },
    "resourceGroupName": {
      "type": "string",
      "metadata": {
        "description": "The resource group the certificate was deployed into."
      },
      "value": "[resourceGroup().name]"
    },
    "name": {
      "type": "string",
      "metadata": {
        "description": "The name of the certificate."
      },
      "value": "[parameters('name')]"
    },
    "thumbprint": {
      "type": "string",
      "metadata": {
        "description": "The thumbprint of the certificate."
      },
      "value": "[reference('certificate').thumbprint]"
    },
    "location": {
      "type": "string",
      "metadata": {
        "description": "The location the resource was deployed into."
      },
      "value": "[reference('certificate', '2024-11-01', 'full').location]"
    }
  }
}